(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9961,        271]
NotebookOptionsPosition[      8430,        227]
NotebookOutlinePosition[      8766,        242]
CellTagsIndexPosition[      8723,        239]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "@", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.714821793476576*^9, 
  3.714821799478409*^9}},ExpressionUUID->"7ee8e319-f123-47b8-b42f-\
6f108beff9d4"],

Cell[BoxData["\<\"/home/eric/git/neurotechnology/resistors\"\>"], "Output",
 CellChangeTimes->{
  3.7148218000320883`*^9, 3.7148224636086397`*^9, 3.714822746106613*^9, {
   3.714823122872414*^9, 
   3.714823151983897*^9}},ExpressionUUID->"d54befed-30dc-4301-9775-\
1a298e94acce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\"\<Year\>\"", ",", "\"\<Package\>\"", ",", "\"\<Value\>\""}], 
     "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"handleYear", "[", 
   RowBox[{"year_", "?", "IntegerQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data1", ",", " ", "pkgNum"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "year", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"data1", "=", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"\"\<raw/Bourns\>\"", "<>", 
          RowBox[{"ToString", "[", "year", "]"}], "<>", "\"\<.xls\>\""}], 
         ",", "\"\<Data\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{"2", ";;", "All"}], ",", 
         RowBox[{"1", ";;", "8"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"pkgNum", "=", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", ";;", "All"}], ",", "2"}], "]"}], "]"}], "]"}]}],
            "]"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"data", ",", 
            RowBox[{"{", 
             RowBox[{"year", ",", " ", "pkgNum", ",", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"year", "\[GreaterEqual]", "2014"}], ",", 
                RowBox[{"val", "*", "1000"}], ",", "val"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"val", ",", " ", "row"}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"row", ",", " ", "data1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"handleYear", "[", "year", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"year", ",", "2012", ",", "2017"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "@", 
  RowBox[{"data", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "20"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.714821788563561*^9, 3.714821859148457*^9}, {
  3.714821889891687*^9, 3.7148223327461443`*^9}, {3.71482254070864*^9, 
  3.714822551581077*^9}, {3.714822748887231*^9, 3.714822786706109*^9}, {
  3.714822889310564*^9, 3.7148229005533953`*^9}, {3.714823149277135*^9, 
  3.714823150143662*^9}},ExpressionUUID->"98993722-6217-47dc-9f6c-\
1656dcbc4a62"],

Cell[CellGroupData[{

Cell[BoxData["2012"], "Print",
 CellChangeTimes->{
  3.714822333175623*^9, 3.714822463826427*^9, 3.714822512354669*^9, {
   3.714822543435029*^9, 3.714822551923253*^9}, {3.71482274615171*^9, 
   3.714822749190928*^9}, {3.714822781646098*^9, 3.714822787097389*^9}, {
   3.7148228910421*^9, 3.714822900873365*^9}, {3.714823123043318*^9, 
   3.714823152113985*^9}},ExpressionUUID->"f43c1598-ecf0-4686-9996-\
a8a79f76245d"],

Cell[BoxData["2013"], "Print",
 CellChangeTimes->{
  3.714822333175623*^9, 3.714822463826427*^9, 3.714822512354669*^9, {
   3.714822543435029*^9, 3.714822551923253*^9}, {3.71482274615171*^9, 
   3.714822749190928*^9}, {3.714822781646098*^9, 3.714822787097389*^9}, {
   3.7148228910421*^9, 3.714822900873365*^9}, {3.714823123043318*^9, 
   3.714823152176915*^9}},ExpressionUUID->"2e676067-0ff7-4607-83aa-\
8ce899d59bb8"],

Cell[BoxData["2014"], "Print",
 CellChangeTimes->{
  3.714822333175623*^9, 3.714822463826427*^9, 3.714822512354669*^9, {
   3.714822543435029*^9, 3.714822551923253*^9}, {3.71482274615171*^9, 
   3.714822749190928*^9}, {3.714822781646098*^9, 3.714822787097389*^9}, {
   3.7148228910421*^9, 3.714822900873365*^9}, {3.714823123043318*^9, 
   3.714823152177897*^9}},ExpressionUUID->"b50f00ea-872f-4c0c-b6c4-\
44beef370d76"],

Cell[BoxData["2015"], "Print",
 CellChangeTimes->{
  3.714822333175623*^9, 3.714822463826427*^9, 3.714822512354669*^9, {
   3.714822543435029*^9, 3.714822551923253*^9}, {3.71482274615171*^9, 
   3.714822749190928*^9}, {3.714822781646098*^9, 3.714822787097389*^9}, {
   3.7148228910421*^9, 3.714822900873365*^9}, {3.714823123043318*^9, 
   3.714823152178927*^9}},ExpressionUUID->"ef9c35b6-b45f-4ca5-97e6-\
a6d37ba8595f"],

Cell[BoxData["2016"], "Print",
 CellChangeTimes->{
  3.714822333175623*^9, 3.714822463826427*^9, 3.714822512354669*^9, {
   3.714822543435029*^9, 3.714822551923253*^9}, {3.71482274615171*^9, 
   3.714822749190928*^9}, {3.714822781646098*^9, 3.714822787097389*^9}, {
   3.7148228910421*^9, 3.714822900873365*^9}, {3.714823123043318*^9, 
   3.714823152216259*^9}},ExpressionUUID->"a85be603-4d19-4ba5-bfa1-\
55eb1c41d2c3"],

Cell[BoxData["2017"], "Print",
 CellChangeTimes->{
  3.714822333175623*^9, 3.714822463826427*^9, 3.714822512354669*^9, {
   3.714822543435029*^9, 3.714822551923253*^9}, {3.71482274615171*^9, 
   3.714822749190928*^9}, {3.714822781646098*^9, 3.714822787097389*^9}, {
   3.7148228910421*^9, 3.714822900873365*^9}, {3.714823123043318*^9, 
   3.7148231522818947`*^9}},ExpressionUUID->"d0ef622d-3a64-4d51-ba00-\
6eb58f31f5b9"]
}, Open  ]],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"Year\"\>", "\<\"Package\"\>", "\<\"Value\"\>"},
    {"2012", "1", "9939.5`"},
    {"2012", "1", "9929.1`"},
    {"2012", "1", "9930.8`"},
    {"2012", "1", "9929.3`"},
    {"2012", "1", "9926.1`"},
    {"2012", "1", "9925.4`"},
    {"2012", "1", "9927.5`"},
    {"2012", "1", "9932.3`"},
    {"2012", "2", "9964.5`"},
    {"2012", "2", "9928.4`"},
    {"2012", "2", "9952.4`"},
    {"2012", "2", "9926.8`"},
    {"2012", "2", "9925.4`"},
    {"2012", "2", "9928.3`"},
    {"2012", "2", "9934.9`"},
    {"2012", "2", "9942.3`"},
    {"2012", "3", "9935.4`"},
    {"2012", "3", "9943.6`"},
    {"2012", "3", "9941.6`"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.714822552069084*^9, {3.714822746279592*^9, 3.714822749374812*^9}, {
   3.714822781836306*^9, 3.714822787211947*^9}, {3.714822891164681*^9, 
   3.7148229009479713`*^9}, {3.714823123840354*^9, 
   3.714823152284135*^9}},ExpressionUUID->"0ed65723-cba2-49c6-b9b9-\
80472389c918"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<resistordata.csv\>\"", ",", "data"}], "]"}]], "Input",
 CellChangeTimes->{{3.714822578451591*^9, 3.7148226052575293`*^9}, {
   3.714822662359996*^9, 3.714822662604162*^9}, 3.7148227363613234`*^9, {
   3.714822908311963*^9, 3.714822912081197*^9}, {3.714823120612076*^9, 
   3.714823126159173*^9}},ExpressionUUID->"d1aa26c9-8652-4c16-b556-\
741829455291"],

Cell[BoxData["\<\"resistordata.csv\"\>"], "Output",
 CellChangeTimes->{
  3.7148226058396473`*^9, 3.714822663118061*^9, 3.714822746321826*^9, 
   3.714822795071314*^9, {3.714822908936489*^9, 3.714822912473736*^9}, {
   3.7148231215989122`*^9, 
   3.714823152379334*^9}},ExpressionUUID->"97b2cd10-3327-4cc5-b4da-\
c7f5bc8f07c5"]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{Automatic, 251}, {25, Automatic}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 225, 5, 32, "Input", "ExpressionUUID" -> \
"7ee8e319-f123-47b8-b42f-6f108beff9d4"],
Cell[808, 29, 279, 5, 32, "Output", "ExpressionUUID" -> \
"d54befed-30dc-4301-9775-1a298e94acce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1124, 39, 2861, 75, 330, "Input", "ExpressionUUID" -> \
"98993722-6217-47dc-9f6c-1656dcbc4a62"],
Cell[CellGroupData[{
Cell[4010, 118, 419, 7, 24, "Print", "ExpressionUUID" -> \
"f43c1598-ecf0-4686-9996-a8a79f76245d"],
Cell[4432, 127, 419, 7, 24, "Print", "ExpressionUUID" -> \
"2e676067-0ff7-4607-83aa-8ce899d59bb8"],
Cell[4854, 136, 419, 7, 24, "Print", "ExpressionUUID" -> \
"b50f00ea-872f-4c0c-b6c4-44beef370d76"],
Cell[5276, 145, 419, 7, 24, "Print", "ExpressionUUID" -> \
"ef9c35b6-b45f-4ca5-97e6-a6d37ba8595f"],
Cell[5698, 154, 419, 7, 24, "Print", "ExpressionUUID" -> \
"a85be603-4d19-4ba5-bfa1-55eb1c41d2c3"],
Cell[6120, 163, 421, 7, 24, "Print", "ExpressionUUID" -> \
"d0ef622d-3a64-4d51-ba00-6eb58f31f5b9"]
}, Open  ]],
Cell[6556, 173, 1084, 31, 372, "Output", "ExpressionUUID" -> \
"0ed65723-cba2-49c6-b9b9-80472389c918"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7677, 209, 407, 7, 34, "Input", "ExpressionUUID" -> \
"d1aa26c9-8652-4c16-b556-741829455291"],
Cell[8087, 218, 327, 6, 32, "Output", "ExpressionUUID" -> \
"97b2cd10-3327-4cc5-b4da-c7f5bc8f07c5"]
}, Open  ]]
}
]
*)

